<?phpif (!isset($_SERVER["REQUEST_URI"])) die("Keine REQUEST-URI vom Apache erhalten!");if (!isset($_SERVER["SCRIPT_NAME"])) die("Keine SCRIPT_NAME vom Apache erhalten!");$_SERVER["REQUEST_URI2"] = substr($_SERVER["REQUEST_URI"],strlen($_SERVER["SCRIPT_NAME"])-10);$p = strpos($_SERVER["REQUEST_URI2"],"?");if (!$p) $_SERVER["REQUEST_URIpure"] = $_SERVER["REQUEST_URI2"]; else $_SERVER["REQUEST_URIpure"] = substr($_SERVER["REQUEST_URI2"],0, $p);switch ($_SERVER["REQUEST_URIpure"]) {	case "/robots.txt":		PageEngine::html("txt_robots");		exit(1);	case "/":	case "/index.php":	case "/index.html":	case "/questions": 		PageEngine::html("page_questions");		exit(1);	case "/cron":		include($_ENV["basepath"]."/app/code/crons/cron.php");		exit(1);	case "/questions/rss": 	case "/questions.rss": 		PageEngine::html("rss_questions");		exit(1);	case "/questions/ask":		PageEngine::runController("ask");		PageEngine::html("page_ask");		exit(1);	case "/account/signin":		PageEngine::runController("login");		PageEngine::html("page_login");		exit(1);	case "/account/signin/facebook":		PageEngine::runController("login_facebook");		exit(1);	case "/account/signout":		PageEngine::runController("logout");		PageEngine::html("page_logout");		exit(1);	case "/account/signup":		PageEngine::runController("register");		PageEngine::html("page_register");		exit(1);	case "/help":		PageEngine::html("page_help");		exit(1);	case "/tags":		PageEngine::html("page_tags");		exit(1);	case "/users":		PageEngine::html("page_users");		exit(1);	case "/badges":		PageEngine::html("page_badges");		exit(1);	case "/feedback":		header('Location: https://sourceforge.net/sendmessage.php?touser=1702485');		exit(1);	case "/about":		PageEngine::html("page_about");	exit(1);	case "/faq":		PageEngine::html("page_faq");	exit(1);	case "/privacy":		PageEngine::html("page_privacy");	exit(1);	case "/sitemap.xml":		PageEngine::html("xml_sitemap");		exit(1);	case "/settings":	case "/admin/settings":		if (!MyUser::hasAdminRight()) PageEngine::html("page_403");		PageEngine::runController("settings");		PageEngine::html("admin/page_settings"); exit(1);	case "/admin/check":	case "/settings/check":		if (!MyUser::hasAdminRight()) PageEngine::html("page_403");		PageEngine::html("admin/page_check"); exit(1);	case "/admin/plugins":		if (!MyUser::hasAdminRight()) PageEngine::html("page_403");		PageEngine::html("admin/page_plugins"); exit(1);	case "/tagicons.css":		PageEngine::html("css_TagIcons"); exit(1);	case "/lastanswers.rss":		PageEngine::html("rss_lastanswers"); exit(1);	case "/lastspamanswers.rss":		PageEngine::html("rss_lastSpamanswers"); exit(1);	default:}/*** jetzt kommen die langsamen pregs ***/if (preg_match("@^/api(/([0-9\.]+))?/([a-z]+)/([a-z]+)(\.(json|xml|plain|txt|php|jsonac|html|json-in-script|successcode))?$@", $_SERVER["REQUEST_URIpure"], $treffer)) {	if ($treffer[2]."" == "") $treffer[2] = "0.1";	if (isset($treffer[6])) $_ENV["API"]["format"] = $treffer[6];	elseif (!isset($_ENV["API"]["format"]) AND isset($_REQUEST["format"])) $_ENV["API"]["format"] = $_REQUEST["format"];	$_ENV["API"]["namespace"] = $treffer[3];	$_ENV["API"]["method"] = $treffer[4];	require($_ENV["basepath"]."/app/api/".$treffer[2]."/main.php");	exit(1);}if (preg_match("@^/question/([0-9]+)/[^\/]+(/[a-z\/]+)?$@", $_SERVER["REQUEST_URIpure"], $treffer)) {	switch (isset($treffer[2])?$treffer[2]:"") {		case "/edit":			PageEngine::runController("question_edit", array("id" => $treffer[1]));			PageEngine::html("page_question_edit", array("id" => $treffer[1]));			exit(1);		case "/rss":			PageEngine::html("rss_questionanswers", array("question" => $treffer[1]));		case "/share/facebook":			PageEngine::html("page_iframe", array("url" => SocialShare::FacebookPermaLink(Question::PermalinkByData($treffer[1]+0)))); exit(1);		case "/share/twitter":			PageEngine::html("page_iframe", array("url" => SocialShare::TwitterPermaLink(Question::PermalinkByData($treffer[1]+0)))); exit(1);		default:			PageEngine::runController("question", array("id" => $treffer[1]));			PageEngine::html("page_question", array("id" => $treffer[1]));			exit(1);	}}if (preg_match ("@^/questions/(.*)$@", $_SERVER["REQUEST_URIpure"], $treffer)) {	PageEngine::html("page_questions");	exit(1);}if (preg_match ("@^/users/([0-9]+)/[^\/]+(/[a-z]+)?$@", $_SERVER["REQUEST_URIpure"], $treffer)) {	switch (isset($treffer[2])?$treffer[2]:"") {		case "/inbox":			if (MyUser::id() != $treffer["1"]+0) PageEngine::html("page_403");			PageEngine::html("page_userinbox", array("user_id" => $treffer["1"]+0));		case "/edit":			if (MyUser::id() != $treffer["1"]+0) PageEngine::html("page_403");			PageEngine::runController("userprofile_edit", array("user_id" => $treffer[1]+0));			PageEngine::html("page_userprofileedit", array("user_id" => $treffer["1"]+0));		case "/karma":			PageEngine::html("page_userkarma", array("user_id" => $treffer["1"]+0));		case "/badges":			PageEngine::html("page_userbadges", array("user_id" => $treffer["1"]+0));		case "/rights":			if (!MyUser::hasAdminRight()) PageEngine::html("page_403");			PageEngine::runController("userprofile_rights", array("user_id" => $treffer[1]+0));			PageEngine::html("page_userprofilerights", array("user_id" => $treffer["1"]+0));		default:			PageEngine::html("page_userprofile", array("user_id" => $treffer["1"]+0));	}		exit(1);}if (preg_match("@^/answers/([0-9]+)(/[a-z]+)?$@", $_SERVER["REQUEST_URIpure"], $treffer)) {	switch (isset($treffer[2])?$treffer[2]:"") {		case "/edit":			PageEngine::runController("answer_edit", array("id" => $treffer[1]+0));			PageEngine::html("page_answer_edit", array("id" => $treffer[1]+0));			exit(1);	}	}if (preg_match ("@^/badges/([0-9]+)/[^\/]+(/[a-z]+)?$@", $_SERVER["REQUEST_URIpure"], $treffer)) {	PageEngine::html("page_badgeprofile", array("badge_id" => $treffer["1"]+0));	exit(1);}if (preg_match("@^/tags/(.*?)(/[a-z\/]+)?$@", $_SERVER["REQUEST_URIpure"], $treffer)) {	switch (isset($treffer[2])?$treffer[2]:"/info") {		case "/info":			PageEngine::runController("tags_info", array("id" => $treffer[1]));			PageEngine::html("page_tags_info", array("id" => $treffer[1]));			exit(1);		case "/info/edit":			if ((!MyUser::isloggedin() OR MyUser::getKarmaPoints() < 2500) AND !MyUser::hasAdminRight()) { PageEngine::html("page_error_karma", array("karma" => 2500)); }			PageEngine::runController("tags_infoedit", array("id" => $treffer[1]));			PageEngine::html("page_tags_infoedit", array("id" => $treffer[1]));			exit(1);		case "/synonyms":			PageEngine::runController("tags_synonyms", array("id" => $treffer[1]));			PageEngine::html("page_tags_synonyms", array("id" => $treffer[1]));			exit(1);	}}Observer::Raise("Error_404",array("path" => $_SERVER["REQUEST_URIpure"]));PageEngine::html("page_404");exit(1);