<?php/* * 1 => Autobiograph: Profil vervollständigt * * */class Badges {	public static $badgelist = array(		1 => array("title" => "Autobiograph", "medal" => 3, "desc" => "Hat sein Benutzerprofil vervollständigt","key" => "b%b_u%u"),		2 => array("title" => "Bürgerpolizist", "medal" => 3, "desc" => "Hat einen Beitrag gemeldet","key" => "b%b_u%u"),		3 => array("title" => "Schreiberling", "medal" => 3, "desc" => "Hat die erste Frage gestellt","key" => "b%b_u%u"),		4 => array("title" => "Helfer", "medal" => 3, "desc" => "Hat die erste Antwort geschrieben","key" => "b%b_u%u"),		5 => array("title" => "Blabberer", "medal" => 3, "desc" => "Hat die erste Kommentar geschrieben","key" => "b%b_u%u"),		6 => array("title" => "Callboy", "medal" => 3, "desc" => "Hilft Usern auch über Skype","key" => "b%b_u%u"),		//3 Chefredakteur		//4 Diszipliniert		//5 DoItYourself-Man		//6 Elementare Frage		//7 Enthusiast		//8 Experte		//9 Favoritenfrage								9 => array("title" => "Kritiker", "medal" => 3, "desc" => "Bewertete einen Beitrag negativ / downvote", "key" => "b%b_u%u"),		10 => array("title" => "Redakteur", "medal" => 3, "desc" => "Editiere einen Beitrag","key" => "b%b_u%u"),		21 => array("title" => "Elementare Frage", "medal" => 1, "desc" => "Stellte eine Frage mit mindestens 500 Views", "key" => "b%b_u%u_q%q"),				24 => array("title" => "Gute Frage", "medal" => 2, "desc" => "Frage wurde mindestens 3mal positiv bewertet / upvoted","key" => "b%b_u%u_q%q"),						31 => array("title" => "Wichtige Frage", "medal" => 2, "desc" => "Stellte eine Frage mit mindestens 250 Views", "key" => "b%b_u%u_q%q"),				41 => array("title" => "Populäre Frage", "medal" => 3, "desc" => "Stellte eine Frage mit mindestens 150 Views", "key" => "b%b_u%u_q%q"),		51 => array("title" => "Tolle Antwort", "medal" => 3, "desc" => "Antwort wurde 3mal positiv bewertet / upvoted", "key" => "b%b_u%u_a%a"),		52 => array("title" => "Gute Antwort", "medal" => 2, "desc" => "Antwort wurde 10mal positiv bewertet / upvoted", "key" => "b%b_u%u_a%a"),		53 => array("title" => "Großartige Antwort", "medal" => 1, "desc" => "Antwort wurde 25mal positiv bewertet / upvoted", "key" => "b%b_u%u_a%a")			);	public static function add($badge, $user = null, $data = array()) {		if ($user == null) $user = MyUser::id();				if (!isset(self::$badgelist[$badge+0])) throw new Exception("Badge existiert nicht! (".($badge+0).")");		$binfo = self::$badgelist[$badge+0];				$db = new SQL(0);		$w = array();		$w["keyID"] = $binfo["key"];		$w["keyID"] = str_replace(array("%b","%u","%q","%a"),array($badge+0, $user+0,(isset($data["question"])?$data["question"]:0),(isset($data["answer"])?$data["answer"]:0)), $w["keyID"]);		$w["user"] = $user+0;		$w["badge"] = $badge+0;		$w["medal"] = $binfo["medal"];		$w["dt_received"] = time();		if (isset($data["question"])) $w["question"] = $data["question"]+0;		$db->CreateUpdate(0, 'user_badges', $w);				switch ($w["medal"]) {			case 1: $db->cmd(0, 'UPDATE LOW_PRIORITY IGNORE user_list as T1 SET award_gold = (SELECT count(*) FROM user_badges WHERE user= T1.id AND medal=1) WHERE id={0} LIMIT 1', true, array($w["user"])); break;			case 2: $db->cmd(0, 'UPDATE LOW_PRIORITY IGNORE user_list as T1 SET award_silver = (SELECT count(*) FROM user_badges WHERE user= T1.id AND medal=2) WHERE id={0} LIMIT 1', true, array($w["user"])); break;			case 3: $db->cmd(0, 'UPDATE LOW_PRIORITY IGNORE user_list as T1 SET award_bronce = (SELECT count(*) FROM user_badges WHERE user= T1.id AND medal=3) WHERE id={0} LIMIT 1', true, array($w["user"])); break;		}		return true;	}		public static function hasBadge($badge, $user) {		$db = new SQL(0);		$row = $db->cmdrow(0, 'SELECT user FROM user_badges WHERE user="{0}" AND badge="{1}" LIMIT 0,1', array($user+0, $badge+0));		return isset($row["user"]);	}}