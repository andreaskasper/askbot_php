<?phpif (isset($_POST["action"]) AND $_POST["action"] == "register") {	$db = new SQL(0);	$j = true;	if (Userlist::userexists($_POST["username"])) { PageEngine::AddErrorMessage("register", "Der Username wird bereits verwendet"); $j = false; }	if($j) {		$passwort = "";		$alpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz";		while (strlen($passwort) < 6) $passwort .= substr($alpha, rand(0, strlen($alpha)), 1);		$w = array();		$w["username"] = $_POST["username"];		$w["email_standard"] = strtolower($_POST["email"]);		$w["dt_registered"] = time();		$db->Create(0, "user_list", $w);		$userid = $db->LastInsertKey();		$w2 = array();		$w2["username"] = "user[".$userid."]";		$w2["pwd"] = md5($passwort);		$w2["provider"] = "local";		$w2["user"] = $userid;		$db->Create(0, "user_login", $w2);				$mail = new PHPMailer();		$mail->SetFrom('no-reply@'.$_SERVER["HTTP_HOST"], 'Registrierung '.SiteConfig::val("page/title"));		$mail->AddAddress($_POST["email"], $w["username"]);		$local = PageEngine::html_find("email_register",".tpl");		$body = file_get_contents($local);		$body = str_replace(array("{{password}}", "{{page_title}}"), array($passwort, SiteConfig::val("page/title","Q/A Forum")), $body);		$mail->Subject = "Deine Registrierung bei ".SiteConfig::val("page/title");		$mail->AltBody = 'Vielen Dank für Deine Registrierung,wir schicken Dir nun Deine Zugangsdaten für '.SiteConfig::val("page/title").'. Solltest Du diese nicht beantragt haben, dann lösche bitte diese Nachricht umgehend, damit nicht Dritte Deine Identität nutzen können.Passwort: '.$passwort.'Wir wünschen Dir viel Spaß auf '.SiteConfig::val("page/title").'';		$mail->MsgHTML($body);		if (!$mail->Send()) {			Observer::Raise("Mail_Send_Error",array("errormsg" => $mail->ErrorInfo));			Observer::Raise("Register_Error",array("errormsg" => "No Mail send", "errormsg" => $mail->ErrorInfo));			PageEngine::AddErrorMessage("register", "Fehler beim senden der E-Mail (".$mail->ErrorInfo.").");		}		PageEngine::AddSuccessMessage("register", "Neuer User angelegt... Bitte prüfe Deine E-Mails!");	}}