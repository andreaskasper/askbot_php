<?phpif (isset($_GET["act"]) && $_GET["act"] == "autocompleteTags") {	$out = array();	$db = new SQL(0);	$rows = $db->cmdrows(0, 'SELECT tag, count(*) as Anzahl FROM question_tags WHERE tag LIKE "%{0}%" GROUP BY tag ORDER BY Anzahl DESC LIMIT 0,10', array($_REQUEST["term"]));	foreach ($rows as $row)	$out[] = array("id" => $row["tag"] ,"label" => $row["tag"], "value" => $row["tag"]);	die(json_encode($out));}PageEngine::html("html_head",array("subtitle" => _h("ask your question"), "nocache" => true));PageEngine::html("header");?><style>nav .searchBar { display: none;}</style>	<div id="Content" class="content-wrapper askForm">		<article class="ContentLeft">			<?php PageEngine::html("messagebox", array("name" => "save")); ?>			<form method="POST"><INPUT type="hidden" name="action" value="save"/>			<INPUT type="text" class="fld_title big" name="title" autocomplete="off" value="<?=(isset($_POST["title"])?html($_POST["title"]):"");?>" placeholder="<?=_e("Wie lautet Deine Frage?"); ?>"/>			<p><?=_e("Bitte gebe einen aussagekräftigen Titel für die Frage ein.");?></p>			<div id="PossibleMultiple">			</div>			<div><?php				PageEngine::html("box_editor",array("placeholder" => _h("Write your question a little more specific..."), "value" => (isset($_POST["text"])?$_POST["text"]:"")));?>			</div>			<strong><?=_e("tags:"); ?></strong><br/>			<input class="fld_tags big" autocomplete="off" type="text" name="tags" size="50" value="<?=(isset($_POST["tags"])?html($_POST["tags"]):(isset($_GET["tag"])?html($_GET["tag"]).',':''));?>" placeholder="tag1, tag2, tag3, ..."/>			<p><?=_e("Tags are short keywords, with no spaces within. Up to 5 tags can be used."); ?></p>			<div id="previewer" class="editor-preview" style="display: block; "></div>						<div class="question-options">				<div class="checkbox" title="<?=_e("Wenn Du community-wiki auswählst, werden auf die Frage und Antworten keine Bewertungspunkte vergeben, der Name des Autors wird nicht angezeigt."); ?>"> <input type="checkbox" name="wiki" id="id_wiki" value="1"> <label for="id_wiki"><?=_e("Community Wiki (Karma wird nicht gezählt, und andere können den Beitrag editieren)"); ?></label></div>				<div class="checkbox" title="<?=_e("Kreuze an wenn du deinen Namen bei einer Frage nicht anzeigen lassen möchtest"); ?>"> <input type="checkbox" <?=(!MyUser::isloggedin()?'disabled="disabled" CHECKED="CHECKED"':"") ?> name="ask_anonymously" id="id_ask_anonymously" value="1"> <label for="id_ask_anonymously"><?=_e("Frage anonym"); ?></label> </div>			</div><?php	if (!MyUser::isloggedin()) {		echo('<p style="color: red;">Du bist aktuell nicht angemeldet. Daher kann Deine Frage nur anonym eingereicht werden und muss erst von einem Moderator geprüft werden. Ausserdem kannst Du die Frage danach nicht mehr bearbeiten. Überlege also, ob Du Dich nicht lieber <a href="'.get_path("account/signin").'">anmeldest</a>.</p>');		echo('<p>Bitte lies auch noch diesen Text:<img src="?antispam=img&t='.time().'"/><INPUT type="text" name="antispam" value="" placeholder="Bitte lies die Buchstaben"/></p>');		}	?>					<button type="submit" class="blue">Stelle deine Frage</button>			</form>		</article>		<aside class="ContentRight"><div id="widget-tags" class="widget tipps"> 	<h2 class="Tipps"><?=_e("Tipps"); ?></h2>	<ul class="tips">		<li><?=_e("Stelle eine Frage die diese Community interessieren könnte");?></li>		<li><?=_e("Hinterlasse genug Details");?></li>		<li><?=_e("Sei klar und deutlich.");?></li>		<li>Wenn Du Bilder in der Zwischenablage hast, dann nutze das Upload Tool von <a href="http://imgur.com" target="_blank" rel="nofollow">imgur.com</a></li>	</ul></div><div id="widget-tags" class="widget markdown"> 	<h2 class="markdown"><?=_e("Markdown Tricks"); ?></h2>	<p><b>[youtube=<i style="color:#008000;">VideoID</i>]</b><br/>	Bindet ein YouTube-Video ein.	</p>	<p><b>[code]<i style="color:#008000;">txt</i>[/code]</b><br/>	<b>[code=<i style="color:#008000;">Sprache</i>]<i style="color:#008000;">txt</i>[/code]</b><br/>	Bindet eine Quellcode ein. Dabei kann die Sprache definiert werden, um Syntax Highlighting einzuschalten.	</p>		</div>				</aside>		</div>	<script>var cacheTag = {};$(document).ready(function() {	dopreview();	$("INPUT.fld_title").change(function() {		var q = $(this).val();		$.post(document.location.href, {action: "possiblequestions", q: q}, function(data) {			$("#PossibleMultiple").slideUp(200).html(data).slideDown(200);		});	});		$("INPUT[name='tags']").bind( "keydown", function( event ) {                if ( event.keyCode === $.ui.keyCode.TAB && $( this ).data( "autocomplete" ).menu.active ) event.preventDefault();            }).autocomplete({                minLength: 0,                source: function( request, response ) {					var term = extractLast( request.term );					if ( term in cacheTag ) {						response( cacheTag[term] );						return;					}										$.getJSON( "?act=autocompleteTags", request, function( data, status, xhr ) {						cacheTag[ term ] = data;						response( data );						return;					});                },                focus: function() {                    // prevent value inserted on focus                    return false;                },                select: function( event, ui ) {                    var terms = splitit( this.value );                    // remove the current input                    terms.pop();                    // add the selected item                    terms.push( ui.item.value );                    // add placeholder to get the comma-and-space at the end                    terms.push( "" );                    this.value = terms.join( ", " );                    return false;                }            });	});function splitit( val ) {	return val.split( /,\s*/ );}function extractLast( term ) {	return splitit( term ).pop();}var lastchecktext = "";function dopreview() {	var a = $("TEXTAREA[name='text']").val();	if (lastchecktext == a)	return setTimeout("dopreview();", 1000);	lastchecktext = a;	$.post(document.location.href, { action: 'preview', text: a}, function(data) { 		$("#previewer").html(data.html);		setTimeout("dopreview();", 5000); 	},"json");}</script>			<?phpPageEngine::html("footer");?>	</body></html><?phpexit(1);?>